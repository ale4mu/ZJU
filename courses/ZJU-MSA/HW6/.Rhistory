options(htmltools.dir.version = FALSE)
library(knitr)
opts_knit$set(eval.after = 'fig.cap')
library(tidyverse)
library(reshape2)
library(ggplot2)
library(readxl)
library(dplyr)
library(readr)
library(tibble)
library(mice)
library(Hmisc)
library(car)
library(cluster)
library(ggrepel)
library(MASS)
library(showtext)
showtext_auto()
df <- read_excel("case6.xls")
str(df)
rownames
rownames()
rownames(1)
rownames(df)
rownames(df) <- df[1,]
rownames(df) <- df[[1]]
df <- read_excel("case6.xls")
rownames(df) <- df[[1]]
df <- df[-1]
print(df)
df <- as.data.frame(read_excel("case6.xls"))
rownames(df) <- df[[1]]
df <- df[-1]
print(df)
df <- as.data.frame(read_excel("case6.xls"))
rownames(df) <- df[[1]]
df <- df[-1]
pca <- prcomp(df,scale. =  TRUE)
print(pca)
princomp(df)
?princomp
princomp(df,cor = TRUE)
pc <- princomp(df,cor = TRUE)
pc$sdev
pc$loadings
df <- as.data.frame(read_excel("case6.xls"))
rownames(df) <- df[[1]]
df <- df[-1]
pca <- princomp(df,cor = TRUE)
cat("特征根的平方根：")
print(pca$sdev)
cat("因子载荷：")
print(pca$loadings)
df <- as.data.frame(read_excel("case6.xls"))
rownames(df) <- df[[1]]
df <- df[-1]
pca <- princomp(df,cor = TRUE)
cat("特征根的平方根：\n")
print(pca$sdev)
cat("因子载荷：\n")
print(pca$loadings)
screeplot(pca, type="lines")
df <- as.data.frame(read_excel("case6.xls"))
rownames(df) <- df[[1]]
df <- df[-1]
pca <- princomp(df,cor = TRUE)
cat("特征根的平方根：\n")
print(pca$sdev)
cat("因子载荷：\n")
print(pca$loadings)
screeplot(pca, type="lines")
print(pca$scores)
df <- as.data.frame(read_excel("case6.xls"))
rownames(df) <- df[[1]]
df <- df[-1]
pca <- princomp(df,cor = TRUE)
cat("特征根的平方根：\n")
print(pca$sdev)
cat("因子载荷：\n")
print(pca$loadings)
print(screeplot(pca, type="lines"))
print(pca$scores)
biplot(pca, choices = 1:2)
d<-dist(pca$score[,1:3])
repca<-hclust(d)
model1<-cutree(repca, k=3)
plot(re)
plot(repca)
df <- as.data.frame(read_excel("case6.xls"))
rownames(df) <- df[[1]]
df <- df[-1]
pca <- princomp(df,cor = TRUE)
cat("特征根的平方根：\n")
print(pca$sdev)
cat("因子载荷：\n")
print(pca$loadings)
print(screeplot(pca, type="lines"))
cat("得分：")
print(pca$scores)
d<-dist(pca$score[,1:6])
repca<-hclust(d)
model1<-cutree(repca, k=3)
plot(repca)
df <- as.data.frame(read_excel("case6.xls"))
rownames(df) <- df[[1]]
df <- df[-1]
pca <- princomp(df,cor = TRUE)
cat("特征根的平方根：\n")
print(pca$sdev)
cat("因子载荷：\n")
print(pca$loadings)
print(screeplot(pca, type="lines"))
cat("得分：")
print(pca$scores)
d<-dist(pca$score[,1:6])
repca<-hclust(d)
model1<-cutree(repca, k=3)
print(plot(repca))
df <- as.data.frame(read_excel("case6.xls"))
rownames(df) <- df[[1]]
df <- df[-1]
pca <- princomp(df,cor = TRUE)
cat("特征根的平方根：\n")
print(pca$sdev)
cat("因子载荷：\n")
print(pca$loadings)
print(screeplot(pca, type="lines"))
cat("得分：")
print(pca$scores)
scores <- pca$score[,1:6]
d<-dist(scores)
repca<-hclust(d)
model1<-cutree(repca, k=3)
print(plot(repca))
set.seed(123)
kmeans_res <- kmeans(scores, centers = 3, nstart = 25)
labels <- kmeans_res$cluster
res <- data.frame(
行业 = rownames(scores),
第一主成分得分 = scores[, 1],
第二主成分得分 = scores[, 2],
第三主成分得分 = scores[,3],
分类 = labels
)
print("\n各行业主成分得分及分类结果:")
print(res)
ggplot(res, aes(x = 第一主成分得分, y = 第二主成分得分, color = factor(分类))) +
geom_point(size = 4) +
geom_text(aes(label = 行业), hjust = 0, vjust = 0, size = 3) +
labs(title = "13个行业在前两个主成分上的分布",
x = "第一主成分得分",
y = "第二主成分得分",
color = "类别") +
theme_minimal()
df <- as.data.frame(read_excel("case6.xls"))
rownames(df) <- df[[1]]
df <- df[-1]
pca <- princomp(df,cor = TRUE)
cat("特征根的平方根：\n")
print(pca$sdev)
cat("因子载荷：\n")
print(pca$loadings)
print(screeplot(pca, type="lines"))
cat("得分：")
print(pca$scores)
scores <- pca$score[,1:6]
d<-dist(scores)
repca<-hclust(d)
model1<-cutree(repca, k=3)
print(plot(repca))
set.seed(123)
kmeans_res <- kmeans(scores, centers = 3, nstart = 25)
labels <- kmeans_res$cluster
res <- data.frame(
第一主成分得分 = scores[, 1],
第二主成分得分 = scores[, 2],
第三主成分得分 = scores[,3],
分类 = labels
)
print("\n各行业主成分得分及分类结果:")
print(res)
ggplot(res, aes(x = 第一主成分得分, y = 第二主成分得分, color = factor(分类))) +
geom_point(size = 4) +
geom_text(aes(label = 行业), hjust = 0, vjust = 0, size = 3) +
labs(title = "13个行业在前两个主成分上的分布",
x = "第一主成分得分",
y = "第二主成分得分",
color = "类别") +
theme_minimal()
df <- as.data.frame(read_excel("case6.xls"))
rownames(df) <- df[[1]]
df <- df[-1]
pca <- princomp(df,cor = TRUE)
cat("特征根的平方根：\n")
print(pca$sdev)
cat("因子载荷：\n")
print(pca$loadings)
print(screeplot(pca, type="lines"))
cat("得分：")
print(pca$scores)
scores <- pca$score[,1:6]
d<-dist(scores)
repca<-hclust(d)
model1<-cutree(repca, k=3)
print(plot(repca))
set.seed(123)
kmeans_res <- kmeans(scores, centers = 3, nstart = 25)
labels <- kmeans_res$cluster
res <- data.frame(
行业 = rownames(scores),
第一主成分得分 = scores[, 1],
第二主成分得分 = scores[, 2],
第三主成分得分 = scores[,3],
分类 = labels
)
print("\n各行业主成分得分及分类结果:")
print(res)
ggplot(res, aes(x = 第一主成分得分, y = 第二主成分得分, color = factor(分类))) +
geom_point(size = 4) +
geom_text(aes(label = 行业), hjust = 0, vjust = 0, size = 3) +
labs(title = "13个行业在前两个主成分上的分布",
x = "第一主成分得分",
y = "第二主成分得分",
color = "类别") +
theme_minimal()
df <- as.data.frame(read_excel("case6.xls"))
rownames(df) <- df[[1]]
df <- df[-1]
pca <- princomp(df,cor = TRUE)
cat("特征根的平方根：\n")
print(pca$sdev)
cat("因子载荷：\n")
print(pca$loadings)
print(screeplot(pca, type="lines"))
cat("得分：")
print(pca$scores)
scores <- pca$score[,1:6]
d<-dist(scores)
repca<-hclust(d)
model1<-cutree(repca, k=3)
print(plot(repca))
set.seed(123)
kmeans_res <- kmeans(scores, centers = 3, nstart = 25)
labels <- kmeans_res$cluster
res <- data.frame(
行业 = rownames(scores),
第一主成分得分 = scores[, 1],
第二主成分得分 = scores[, 2],
第三主成分得分 = scores[,3],
分类 = labels
)
print("\n各行业分类结果:")
print(res$分类)
ggplot(res, aes(x = 第一主成分得分, y = 第二主成分得分, color = factor(分类))) +
geom_point(size = 4) +
geom_text(aes(label = 行业), hjust = 0, vjust = 0, size = 3) +
labs(title = "13个行业在前两个主成分上的分布",
x = "第一主成分得分",
y = "第二主成分得分",
color = "类别") +
theme_minimal()
df <- as.data.frame(read_excel("case6.xls"))
rownames(df) <- df[[1]]
df <- df[-1]
pca <- princomp(df,cor = TRUE)
cat("特征根的平方根：\n")
print(pca$sdev)
cat("因子载荷：\n")
print(pca$loadings)
print(screeplot(pca, type="lines"))
cat("得分：")
print(pca$scores)
scores <- pca$score[,1:6]
d<-dist(scores)
repca<-hclust(d)
model1<-cutree(repca, k=3)
print(plot(repca))
set.seed(123)
kmeans_res <- kmeans(scores, centers = 3, nstart = 25)
labels <- kmeans_res$cluster
res <- data.frame(
行业 = rownames(scores),
第一主成分得分 = scores[, 1],
第二主成分得分 = scores[, 2],
第三主成分得分 = scores[,3],
分类 = labels
)
print("\n各行业分类结果:")
print(table(res$分类))
ggplot(res, aes(x = 第一主成分得分, y = 第二主成分得分, color = factor(分类))) +
geom_point(size = 4) +
geom_text(aes(label = 行业), hjust = 0, vjust = 0, size = 3) +
labs(title = "13个行业在前两个主成分上的分布",
x = "第一主成分得分",
y = "第二主成分得分",
color = "类别") +
theme_minimal()
df <- as.data.frame(read_excel("case6.xls"))
rownames(df) <- df[[1]]
df <- df[-1]
pca <- princomp(df,cor = TRUE)
cat("特征根的平方根：\n")
print(pca$sdev)
cat("因子载荷：\n")
print(pca$loadings)
print(screeplot(pca, type="lines"))
cat("得分：")
print(pca$scores)
scores <- pca$score[,1:6]
d<-dist(scores)
repca<-hclust(d)
model1<-cutree(repca, k=3)
print(plot(repca))
set.seed(123)
kmeans_res <- kmeans(scores, centers = 3, nstart = 25)
labels <- kmeans_res$cluster
res <- data.frame(
行业 = rownames(scores),
第一主成分得分 = scores[, 1],
第二主成分得分 = scores[, 2],
第三主成分得分 = scores[,3],
分类 = labels
)
print("\n各行业分类结果:")
print(res[,5])
ggplot(res, aes(x = 第一主成分得分, y = 第二主成分得分, color = factor(分类))) +
geom_point(size = 4) +
geom_text(aes(label = 行业), hjust = 0, vjust = 0, size = 3) +
labs(title = "13个行业在前两个主成分上的分布",
x = "第一主成分得分",
y = "第二主成分得分",
color = "类别") +
theme_minimal()
df <- as.data.frame(read_excel("case6.xls"))
rownames(df) <- df[[1]]
df <- df[-1]
pca <- princomp(df,cor = TRUE)
cat("特征根的平方根：\n")
print(pca$sdev)
cat("因子载荷：\n")
print(pca$loadings)
print(screeplot(pca, type="lines"))
cat("得分：")
print(pca$scores)
scores <- pca$score[,1:6]
d<-dist(scores)
repca<-hclust(d)
model1<-cutree(repca, k=3)
print(plot(repca))
set.seed(123)
kmeans_res <- kmeans(scores, centers = 3, nstart = 25)
labels <- kmeans_res$cluster
res <- data.frame(
行业 = rownames(scores),
第一主成分得分 = scores[, 1],
第二主成分得分 = scores[, 2],
第三主成分得分 = scores[,3],
分类 = labels
)
print("\n各行业分类结果:")
print(res)
ggplot(res, aes(x = 第一主成分得分, y = 第二主成分得分, color = factor(分类))) +
geom_point(size = 4) +
geom_text(aes(label = 行业), hjust = 0, vjust = 0, size = 3) +
labs(title = "13个行业在前两个主成分上的分布",
x = "第一主成分得分",
y = "第二主成分得分",
color = "类别") +
theme_minimal()
summary(pca)
?pca
?princomp
