exam_data <- data.frame(
X1 = c(X1_left, X1_right),
X2 = c(X2_left, X2_right),
X3 = c(X3_left, X3_right),
X4 = c(X4_left, X4_right),
X5 = c(X5_left, X5_right)
)
summary(exam_data)
fa_result <- factanal(
exam_data,
factors = 2,
rotation = "varimax",
scores = "regression"
)
fa_result
fa_result <- factanal(
exam_data,
factors = 3,
rotation = "varimax",
scores = "regression"
)
fa_result
fa_result <- fa(
exam_data,
factors = 3,
rotation = "varimax",
scores = "regression"
)
?fa
library(psych)
# 左半部分数据（22名学生）
X1_left <- c(77,75,63,51,62,52,50,31,44,62,44,12,54,44,46,30,40,36,46,42,23,41)
X2_left <- c(82,73,63,67,60,64,50,55,69,46,61,58,49,56,52,69,27,59,56,60,55,63)
X3_left <- c(67,71,65,65,58,60,64,60,53,61,52,61,56,55,65,50,54,51,57,54,59,49)
X4_left <- c(67,66,70,65,62,63,55,57,53,57,62,63,47,61,50,52,61,45,49,49,53,46)
X5_left <- c(81,81,63,68,70,54,63,73,53,45,46,67,53,35,33,45,61,51,32,33,44,34)
# 右半部分数据（22名学生）
X1_right <- c(63,55,53,59,64,55,65,60,42,31,49,49,54,18,32,46,31,56,45,40,48,46)
X2_right <- c(78,72,61,70,72,67,63,64,69,49,41,53,53,44,45,49,42,40,42,63,48,52)
X3_right <- c(80,63,72,68,60,59,58,56,61,62,61,49,46,50,49,53,48,56,55,53,49,53)
X4_right <- c(70,70,64,62,62,62,56,54,55,63,49,62,59,57,57,59,54,54,56,54,51,41)
X5_right <- c(81,68,73,56,45,44,37,40,45,62,64,47,44,81,64,37,35,40,25,37,40,40)
# 合并为完整数据集
exam_data <- data.frame(
X1 = c(X1_left, X1_right),
X2 = c(X2_left, X2_right),
X3 = c(X3_left, X3_right),
X4 = c(X4_left, X4_right),
X5 = c(X5_left, X5_right)
)
fa_result <- fa(
r = exam_data,       # 原始数据
nfactors = 2,        # 提取2个因子
rotate = "varimax",  # 旋转方法
fm = "pa",           # 因子提取方法：主轴因子法（Principal Axis Factoring）
scores = "regression" # 计算因子得分
)
# 查看详细结果
print(fa_result, digits = 3)
fa_result <- fa(
r = exam_data,       # 原始数据
nfactors = 3,        # 提取2个因子
rotate = "varimax",  # 旋转方法
fm = "pa",           # 因子提取方法：主轴因子法（Principal Axis Factoring）
scores = "regression" # 计算因子得分
)
fa_result <- factanal(
exam_data,
factors = 2,
rotation = "varimax",
scores = "regression"
)
fa_result
communality2 <- 1 - fa_result$uniquenesses
df_communality2 <- data.frame(
变量 = names(communality2),
公因子方差 = round(communality2, 3)
)
print(df_communality2)
fa_oblimin <- factanal(exam_data, factors=2, rotation="oblimin")
?factanal
fa_result <- factanal(
exam_data,
factors = 2,
rotation = "varimax",
scores = "Bartlett"
)
fa_result
# 1. 创建数据集
# 根据表8.3输入44名学生的成绩数据
scores <- data.frame(
X1 = c(77,75,63,51,62,52,50,31,44,62,44,12,54,44,46,30,40,36,46,42,23,41,
63,55,53,59,64,55,65,60,42,31,49,49,32,46,31,56,45,40,40,48,46,54),
X2 = c(82,73,63,67,60,64,50,55,69,46,61,58,49,56,52,69,27,59,56,60,55,63,
78,72,61,70,72,67,63,64,69,49,41,53,45,49,42,40,42,63,48,52,52,72),
X3 = c(67,71,65,65,58,60,64,60,53,61,52,61,55,55,65,50,54,51,57,54,59,49,
80,63,72,68,60,59,58,56,61,62,61,58,50,53,48,56,55,53,49,53,53,70),
X4 = c(67,66,70,65,62,63,55,57,53,57,62,63,61,50,50,52,61,45,49,49,53,46,
70,70,64,62,62,62,56,54,55,63,49,62,57,59,54,54,56,54,51,41,41,68),
X5 = c(81,81,63,68,70,54,63,73,53,45,46,67,36,61,35,45,61,51,32,33,44,34,
81,68,73,56,45,37,40,45,62,64,64,47,81,64,68,35,25,37,40,40,40,73)
)
# 2. 计算相关矩阵
R <- cor(scores)
cat("相关矩阵R:\n")
print(round(R, 2))
# 3. 分块相关矩阵
# X组(闭卷): X1, X2
# Y组(开卷): X3, X4, X5
R11 <- R[1:2, 1:2]
R22 <- R[3:5, 3:5]
R12 <- R[1:2, 3:5]
R21 <- t(R12)
cat("\n分块相关矩阵:\n")
cat("R11:\n")
print(round(R11, 2))
cat("\nR22:\n")
print(round(R22, 2))
cat("\nR12:\n")
print(round(R12, 2))
# 4. 计算M1* = R11^-1 * R12 * R22^-1 * R21
R11_inv <- solve(R11)
R22_inv <- solve(R22)
M1_star <- R11_inv %*% R12 %*% R22_inv %*% R21
cat("\nM1*矩阵:\n")
print(round(M1_star, 4))
# 5. 求M1*的特征值和特征向量
eigen_result <- eigen(M1_star)
eigenvalues <- eigen_result$values
eigenvectors <- eigen_result$vectors
cat("\nM1*的特征值:\n")
print(round(eigenvalues, 4))
# 6. 计算典型相关系数
canonical_correlations <- sqrt(eigenvalues)
cat("\n典型相关系数:\n")
print(round(canonical_correlations, 4))
# 7. 标准化特征向量 (满足a'R11a = 1的条件)
# 对于每个特征向量a，计算标准化系数
a_list <- list()
for (i in 1:2) {
a <- eigenvectors[, i]
norm_factor <- sqrt(t(a) %*% R11 %*% a)
a_std <- a / norm_factor
a_list[[i]] <- a_std
}
cat("\n标准化后的典型变量系数a (满足a'R11a = 1):\n")
for (i in 1:2) {
cat(sprintf("a%d = ", i))
print(round(a_list[[i]], 4))
}
# 8. 计算b向量 (满足b'R22b = 1的条件)
b_list <- list()
for (i in 1:2) {
a <- a_list[[i]]
b <- (1/canonical_correlations[i]) * R22_inv %*% t(R12) %*% R11_inv %*% a
norm_factor <- sqrt(t(b) %*% R22 %*% b)
b_std <- b / norm_factor
b_list[[i]] <- b_std
}
# 1. 创建数据集
scores <- data.frame(
X1 = c(77,75,63,51,62,52,50,31,44,62,44,12,54,44,46,30,40,36,46,42,23,41,
63,55,53,59,64,55,65,60,42,31,49,49,32,46,31,56,45,40,40,48,46,54),
X2 = c(82,73,63,67,60,64,50,55,69,46,61,58,49,56,52,69,27,59,56,60,55,63,
78,72,61,70,72,67,63,64,69,49,41,53,45,49,42,40,42,63,48,52,52,72),
X3 = c(67,71,65,65,58,60,64,60,53,61,52,61,55,55,65,50,54,51,57,54,59,49,
80,63,72,68,60,59,58,56,61,62,61,58,50,53,48,56,55,53,49,53,53,70),
X4 = c(67,66,70,65,62,63,55,57,53,57,62,63,61,50,50,52,61,45,49,49,53,46,
70,70,64,62,62,62,56,54,55,63,49,62,57,59,54,54,56,54,51,41,41,68),
X5 = c(81,81,63,68,70,54,63,73,53,45,46,67,36,61,35,45,61,51,32,33,44,34,
81,68,73,56,45,37,40,45,62,64,64,47,81,64,68,35,25,37,40,40,40,73)
)
# 2. 计算相关矩阵
R <- cor(scores)
# 3. 分块相关矩阵
R11 <- R[1:2, 1:2]  # 闭卷组内相关
R22 <- R[3:5, 3:5]  # 开卷组内相关
R12 <- R[1:2, 3:5]  # 两组间相关
R21 <- t(R12)
# 4. 计算M1* = R11^-1 * R12 * R22^-1 * R21
R11_inv <- solve(R11)
R22_inv <- solve(R22)
M1_star <- R11_inv %*% R12 %*% R22_inv %*% R21
# 5. 求M1*的特征值和特征向量
eigen_result <- eigen(M1_star)
eigenvalues <- eigen_result$values
eigenvectors <- eigen_result$vectors
# 6. 计算典型相关系数
canonical_correlations <- sqrt(eigenvalues)
# 7. 标准化特征向量 (满足a'R11a = 1的条件)
a_list <- list()
for (i in 1:2) {
a <- eigenvectors[, i]
norm_factor <- sqrt(t(a) %*% R11 %*% a)
a_std <- as.vector(a / as.numeric(norm_factor))  # 确保转换为向量
a_list[[i]] <- a_std
}
# 8. 计算b向量 (满足b'R22b = 1的条件) - 修正部分
b_list <- list()
for (i in 1:2) {
a <- a_list[[i]]
# 计算b向量
b <- (1/canonical_correlations[i]) * R22_inv %*% t(R12) %*% R11_inv %*% a
# 将b转换为向量
b <- as.vector(b)
# 计算标准化因子
norm_factor <- sqrt(t(b) %*% R22 %*% b)
# 标准化b向量 - 关键修正：确保norm_factor是标量
b_std <- b / as.numeric(norm_factor)
b_list[[i]] <- b_std
}
# 9. 打印结果
cat("标准化后的典型变量系数a (满足a'R11a = 1):\n")
for (i in 1:2) {
cat(sprintf("a%d = ", i))
print(round(a_list[[i]], 4))
}
cat("\n标准化后的典型变量系数b (满足b'R22b = 1):\n")
for (i in 1:2) {
cat(sprintf("b%d = ", i))
print(round(b_list[[i]], 4))
}
cat("\n典型相关系数:\n")
print(round(canonical_correlations, 4))
# 10. 构造典型相关变量
cat("\n第一对典型相关变量:\n")
cat("V1 = ", round(a_list[[1]][1], 4), "X1 + ", round(a_list[[1]][2], 4), "X2\n")
cat("W1 = ", round(b_list[[1]][1], 4), "X3 + ", round(b_list[[1]][2], 4), "X4 + ",
round(b_list[[1]][3], 4), "X5\n")
cat("典型相关系数ρ1 = ", round(canonical_correlations[1], 4), "\n\n")
cat("第二对典型相关变量:\n")
cat("V2 = ", round(a_list[[2]][1], 4), "X1 + ", round(a_list[[2]][2], 4), "X2\n")
cat("W2 = ", round(b_list[[2]][1], 4), "X3 + ", round(b_list[[2]][2], 4), "X4 + ",
round(b_list[[2]][3], 4), "X5\n")
cat("典型相关系数ρ2 = ", round(canonical_correlations[2], 4), "\n")
# 11. 验证标准化条件
cat("\n验证标准化条件:\n")
for (i in 1:2) {
a <- a_list[[i]]
norm_a <- t(a) %*% R11 %*% a
cat(sprintf("a%d'R11a%d = %.4f\n", i, i, as.numeric(norm_a)))
b <- b_list[[i]]
norm_b <- t(b) %*% R22 %*% b
cat(sprintf("b%d'R22b%d = %.4f\n", i, i, as.numeric(norm_b)))
}
# 12. 使用R内置函数验证结果
cat("\n\n使用R内置cancor函数验证:\n")
X <- as.matrix(scores[, 1:2])  # 闭卷组
Y <- as.matrix(scores[, 3:5])  # 开卷组
cancor_result <- cancor(X, Y)
cat("典型相关系数:\n")
print(round(cancor_result$cor, 4))
cat("\nX组系数:\n")
print(round(cancor_result$xcoef, 4))
cat("\nY组系数:\n")
print(round(cancor_result$ycoef, 4))
# 1. 创建数据集 - 38名学生的体质与运动能力数据
students <- data.frame(
X1 = c(46,52,46,49,42,48,49,48,45,48,49,47,41,52,45,49,53,47,48,49,48,42,54,53,42,46,45,50,42,48,42,48,49,47,49,44,52,48),
X2 = c(55,55,69,50,55,61,60,63,55,64,52,62,51,55,52,57,65,57,60,55,69,57,64,63,71,66,56,60,51,50,52,67,74,55,74,52,66,68),
X3 = c(126,95,107,105,90,106,100,122,105,120,100,100,101,125,94,110,112,95,120,113,128,122,155,120,138,120,91,120,126,115,140,105,151,113,120,110,130,100),
X4 = c(51,42,38,48,46,43,49,52,48,38,42,34,53,43,50,47,47,47,47,41,42,46,51,42,44,45,29,42,50,41,48,39,49,40,53,37,47,45),
X5 = c(75.0,81.2,98.0,97.6,66.5,78.0,90.6,56.0,76.0,60.2,53.4,61.2,62.4,86.3,51.4,72.3,90.4,72.3,86.4,84.1,47.9,54.2,71.4,56.6,65.2,62.2,66.2,56.6,50.0,52.9,56.3,69.2,54.2,71.4,54.5,54.9,45.9,53.6),
X6 = c(25,18,18,16,2,25,15,17,15,20,6,10,5,5,20,19,15,9,12,15,20,15,19,8,17,22,18,8,13,6,15,23,20,19,22,14,14,23),
X7 = c(72,50,74,60,68,58,60,68,61,62,42,62,60,62,65,45,75,64,62,60,63,63,61,53,55,68,51,57,57,39,60,60,58,64,59,57,45,70),
X8 = c(6.8,7.2,6.8,6.8,7.2,7.0,7.0,7.0,6.8,7.0,7.4,7.2,8.0,6.8,7.6,7.0,6.6,6.6,6.8,7.0,7.0,7.2,6.9,7.5,7.0,7.4,7.9,6.8,7.7,7.4,6.9,7.6,7.0,7.6,6.9,7.5,6.8,7.2),
X9 = c(489,464,430,362,453,405,420,466,415,413,404,427,372,496,394,446,420,447,398,398,485,400,511,430,487,470,380,460,398,415,470,450,500,410,500,400,505,522),
X10 = c(27,30,32,26,23,29,21,28,24,28,23,25,25,30,24,30,30,25,28,27,30,28,33,29,29,28,26,32,27,28,27,28,30,29,33,29,28,28),
X11 = c(8,5,9,6,11,7,10,2,6,7,6,7,3,10,3,11,12,4,11,4,7,6,12,4,9,7,5,5,2,6,11,10,12,7,21,2,11,9),
X12 = c(360,348,386,331,391,389,379,362,386,398,400,407,409,350,399,337,357,447,381,387,350,388,298,353,370,360,358,348,383,314,348,326,330,331,348,421,355,352)
)
# 2. 计算相关矩阵
R <- cor(students)
# 3. 分块相关矩阵
# X组(体质): X1-X7 (7个变量)
# Y组(运动能力): X8-X12 (5个变量)
R11 <- R[1:7, 1:7]  # 体质组内相关
R22 <- R[8:12, 8:12]  # 运动能力组内相关
R12 <- R[1:7, 8:12]  # 两组间相关
R21 <- t(R12)
# 4. 计算M1* = R11^-1 * R12 * R22^-1 * R21
R11_inv <- solve(R11)
R22_inv <- solve(R22)
M1_star <- R11_inv %*% R12 %*% R22_inv %*% R21
# 5. 求M1*的特征值和特征向量
eigen_result <- eigen(M1_star)
eigenvalues <- eigen_result$values
eigenvectors <- eigen_result$vectors
# 6. 计算典型相关系数 (取前5个，因为min(7,5)=5)
n_pairs <- min(nrow(R11), nrow(R22))
canonical_correlations <- sqrt(eigenvalues[1:n_pairs])
# 7. 标准化特征向量 (满足a'R11a = 1的条件)
a_list <- list()
for (i in 1:n_pairs) {
a <- eigenvectors[, i]
norm_factor <- sqrt(t(a) %*% R11 %*% a)
a_std <- as.vector(a / as.numeric(norm_factor))
a_list[[i]] <- a_std
}
# 8. 计算b向量 (满足b'R22b = 1的条件)
b_list <- list()
for (i in 1:n_pairs) {
a <- a_list[[i]]
b <- (1/canonical_correlations[i]) * R22_inv %*% t(R12) %*% R11_inv %*% a
b <- as.vector(b)
norm_factor <- sqrt(t(b) %*% R22 %*% b)
b_std <- b / as.numeric(norm_factor)
b_list[[i]] <- b_std
}
# 9. 输出结果
cat("相关矩阵R (部分显示):\n")
print(round(R[1:5, 1:5], 2))
cat("\n分块相关矩阵R11 (体质组内相关):\n")
print(round(R11, 2))
cat("\n分块相关矩阵R22 (运动能力组内相关):\n")
print(round(R22, 2))
cat("\nM1*矩阵:\n")
print(round(M1_star, 4))
cat("\nM1*的特征值:\n")
print(round(eigenvalues[1:n_pairs], 4))
cat("\n典型相关系数:\n")
for (i in 1:n_pairs) {
cat(sprintf("ρ%d = %.4f\n", i, canonical_correlations[i]))
}
cat("\n标准化后的典型变量系数a (满足a'R11a = 1):\n")
for (i in 1:n_pairs) {
cat(sprintf("a%d = ", i))
print(round(a_list[[i]], 4))
}
cat("\n标准化后的典型变量系数b (满足b'R22b = 1):\n")
for (i in 1:n_pairs) {
cat(sprintf("b%d = ", i))
print(round(b_list[[i]], 4))
}
cat("\n典型相关变量:\n")
for (i in 1:n_pairs) {
cat(sprintf("第%d对典型相关变量:\n", i))
cat("V", i, " = ", sep = "")
for (j in 1:7) {
if (j > 1 && a_list[[i]][j] >= 0) cat(" + ")
if (a_list[[i]][j] < 0) cat(" - ")
cat(sprintf("%.4fX%d", abs(a_list[[i]][j]), j))
}
cat("\n")
cat("W", i, " = ", sep = "")
for (j in 1:5) {
if (j > 1 && b_list[[i]][j] >= 0) cat(" + ")
if (b_list[[i]][j] < 0) cat(" - ")
cat(sprintf("%.4fX%d", abs(b_list[[i]][j]), j+7))
}
cat("\n")
cat("典型相关系数ρ", i, " = ", round(canonical_correlations[i], 4), "\n\n", sep = "")
}
# 1. 创建数据集 - 38名学生的体质与运动能力数据
students <- data.frame(
X1 = c(46,52,46,49,42,48,49,48,45,48,49,47,41,52,45,49,53,47,48,49,48,42,54,53,42,46,45,50,42,48,42,48,49,47,49,44,52,48),
X2 = c(55,55,69,50,55,61,60,63,55,64,52,62,51,55,52,57,65,57,60,55,69,57,64,63,71,66,56,60,51,50,52,67,74,55,74,52,66,68),
X3 = c(126,95,107,105,90,106,100,122,105,120,100,100,101,125,94,110,112,95,120,113,128,122,155,120,138,120,91,120,126,115,140,105,151,113,120,110,130,100),
X4 = c(51,42,38,48,46,43,49,52,48,38,42,34,53,43,50,47,47,47,47,41,42,46,51,42,44,45,29,42,50,41,48,39,49,40,53,37,47,45),
X5 = c(75.0,81.2,98.0,97.6,66.5,78.0,90.6,56.0,76.0,60.2,53.4,61.2,62.4,86.3,51.4,72.3,90.4,72.3,86.4,84.1,47.9,54.2,71.4,56.6,65.2,62.2,66.2,56.6,50.0,52.9,56.3,69.2,54.2,71.4,54.5,54.9,45.9,53.6),
X6 = c(25,18,18,16,2,25,15,17,15,20,6,10,5,5,20,19,15,9,12,15,20,15,19,8,17,22,18,8,13,6,15,23,20,19,22,14,14,23),
X7 = c(72,50,74,60,68,58,60,68,61,62,42,62,60,62,65,45,75,64,62,60,63,63,61,53,55,68,51,57,57,39,60,60,58,64,59,57,45,70),
X8 = c(6.8,7.2,6.8,6.8,7.2,7.0,7.0,7.0,6.8,7.0,7.4,7.2,8.0,6.8,7.6,7.0,6.6,6.6,6.8,7.0,7.0,7.2,6.9,7.5,7.0,7.4,7.9,6.8,7.7,7.4,6.9,7.6,7.0,7.6,6.9,7.5,6.8,7.2),
X9 = c(489,464,430,362,453,405,420,466,415,413,404,427,372,496,394,446,420,447,398,398,485,400,511,430,487,470,380,460,398,415,470,450,500,410,500,400,505,522),
X10 = c(27,30,32,26,23,29,21,28,24,28,23,25,25,30,24,30,30,25,28,27,30,28,33,29,29,28,26,32,27,28,27,28,30,29,33,29,28,28),
X11 = c(8,5,9,6,11,7,10,2,6,7,6,7,3,10,3,11,12,4,11,4,7,6,12,4,9,7,5,5,2,6,11,10,12,7,21,2,11,9),
X12 = c(360,348,386,331,391,389,379,362,386,398,400,407,409,350,399,337,357,447,381,387,350,388,298,353,370,360,358,348,383,314,348,326,330,331,348,421,355,352)
)
# 2. 计算相关矩阵
R <- cor(students)
# 3. 分块相关矩阵
# X组(体质): X1-X7 (7个变量)
# Y组(运动能力): X8-X12 (5个变量)
R11 <- R[1:7, 1:7]  # 体质组内相关
R22 <- R[8:12, 8:12]  # 运动能力组内相关
R12 <- R[1:7, 8:12]  # 两组间相关
R21 <- t(R12)
# 4. 计算M1* = R11^-1 * R12 * R22^-1 * R21
R11_inv <- solve(R11)
R22_inv <- solve(R22)
M1_star <- R11_inv %*% R12 %*% R22_inv %*% R21
# 5. 求M1*的特征值和特征向量
eigen_result <- eigen(M1_star)
eigenvalues <- eigen_result$values
eigenvectors <- eigen_result$vectors
# 检查是否有复数特征值
complex_indices <- which(Im(eigenvalues) != 0)
if (length(complex_indices) > 0) {
cat("警告：存在复数特征值，将取实部\n")
eigenvalues <- Re(eigenvalues)
eigenvectors <- Re(eigenvectors)
}
# 6. 计算典型相关系数 (取前5个，因为min(7,5)=5)
n_pairs <- min(nrow(R11), nrow(R22))
canonical_correlations <- sqrt(pmax(0, eigenvalues[1:n_pairs]))  # 确保非负
# 7. 标准化特征向量 (满足a'R11a = 1的条件)
a_list <- list()
for (i in 1:n_pairs) {
a <- eigenvectors[, i]
# 取实部，避免复数问题
a <- Re(a)
norm_factor <- sqrt(t(a) %*% R11 %*% a)
a_std <- as.vector(a / as.numeric(norm_factor))
a_list[[i]] <- a_std
}
# 8. 计算b向量 (满足b'R22b = 1的条件)
b_list <- list()
for (i in 1:n_pairs) {
a <- a_list[[i]]
b <- (1/canonical_correlations[i]) * R22_inv %*% t(R12) %*% R11_inv %*% a
b <- as.vector(Re(b))  # 取实部
norm_factor <- sqrt(t(b) %*% R22 %*% b)
b_std <- b / as.numeric(norm_factor)
b_list[[i]] <- b_std
}
# 9. 输出结果
cat("相关矩阵R (部分显示):\n")
print(round(R[1:5, 1:5], 2))
cat("\nM1*矩阵特征值:\n")
print(round(eigenvalues[1:n_pairs], 4))
cat("\n典型相关系数:\n")
for (i in 1:n_pairs) {
cat(sprintf("ρ%d = %.4f\n", i, canonical_correlations[i]))
}
# 10. 构造典型相关变量 - 修正版本
cat("\n典型相关变量:\n")
for (i in 1:n_pairs) {
cat(sprintf("第%d对典型相关变量:\n", i))
# 构造V_i
cat("V", i, " = ", sep = "")
first_term <- TRUE
for (j in 1:7) {
coef <- a_list[[i]][j]
if (abs(coef) < 1e-6) next  # 忽略接近0的系数
# 确定符号
if (first_term) {
if (coef < 0) cat("-")
first_term <- FALSE
} else {
if (coef >= 0) cat(" + ")
else cat(" - ")
}
cat(sprintf("%.4fX%d", abs(coef), j))
}
cat("\n")
# 构造W_i
cat("W", i, " = ", sep = "")
first_term <- TRUE
for (j in 1:5) {
coef <- b_list[[i]][j]
if (abs(coef) < 1e-6) next  # 忽略接近0的系数
# 确定符号
if (first_term) {
if (coef < 0) cat("-")
first_term <- FALSE
} else {
if (coef >= 0) cat(" + ")
else cat(" - ")
}
cat(sprintf("%.4fX%d", abs(coef), j+7))
}
cat("\n")
cat("典型相关系数ρ", i, " = ", round(canonical_correlations[i], 4), "\n\n", sep = "")
}
# 11. 验证标准化条件
cat("验证标准化条件:\n")
for (i in 1:n_pairs) {
a <- a_list[[i]]
norm_a <- t(a) %*% R11 %*% a
cat(sprintf("a%d'R11a%d = %.4f\n", i, i, as.numeric(norm_a)))
b <- b_list[[i]]
norm_b <- t(b) %*% R22 %*% b
cat(sprintf("b%d'R22b%d = %.4f\n", i, i, as.numeric(norm_b)))
}
# 12. 使用R内置函数验证结果
cat("\n\n使用R内置cancor函数验证:\n")
X <- as.matrix(students[, 1:7])  # 体质组
Y <- as.matrix(students[, 8:12])  # 运动能力组
cancor_result <- cancor(X, Y)
cat("典型相关系数:\n")
print(round(cancor_result$cor[1:n_pairs], 4))
# 13. 结果分析
cat("\n\n===== 结果分析 =====\n")
cat(sprintf("第一典型相关系数 ρ1 = %.4f\n", canonical_correlations[1]))
cat("这表明学生体质指标与运动能力指标之间存在较强的线性相关关系\n\n")
cat("主要体质指标贡献:\n")
top_a1 <- order(abs(a_list[[1]]), decreasing = TRUE)[1:3]
for (j in top_a1) {
cat(sprintf("- X%d (系数=%.4f): ", j, a_list[[1]][j]))
if (j == 1) cat("反复横荡次数\n")
else if (j == 2) cat("纵跳高度\n")
else if (j == 3) cat("背力\n")
else if (j == 4) cat("握力\n")
else if (j == 5) cat("体重\n")
else if (j == 6) cat("胸围\n")
else if (j == 7) cat("卧姿上体后伸\n")
}
cat("\n主要运动能力指标贡献:\n")
top_b1 <- order(abs(b_list[[1]]), decreasing = TRUE)[1:3]
for (j in top_b1) {
cat(sprintf("- X%d (系数=%.4f): ", j+7, b_list[[1]][j]))
if (j+7 == 8) cat("50米跑\n")
else if (j+7 == 9) cat("1000米长跑\n")
else if (j+7 == 10) cat("投掷\n")
else if (j+7 == 11) cat("跳远\n")
else if (j+7 == 12) cat("持米走\n")
}
cat("\n结论: 体质指标中，背力、握力和卧姿上体后伸对运动能力影响最大；\n")
cat("运动能力指标中，1000米长跑、持米走和跳远是主要反映体质水平的项目。\n")
cat("这表明学生的力量素质和耐力素质是影响整体运动能力的关键因素。\n")
cat("这表明学生的力量素质和耐力素质是影响整体运动能力的关键因素。\n")
R
